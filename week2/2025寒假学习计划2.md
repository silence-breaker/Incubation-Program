# week3+week4
## 关于pr所有的报错总结及解决办法
1.  ! [rejected]        wyc -> wyc (non-fast-forward)
error: failed to push some refs to 'git@github.com:wlycf2/Incubation-Program.git'
	解决办法：采用语句： git push --force origin wyc；即为强制push，不考虑最新的拉取
2. Updates were rejected because the tip of your current branch is behind.
	解决办法：先采取git pull尝试拉取，再重新添加修改文件，最后git push
3. Failed to start sshd.service: Unit sshd.service not found.
	解决办法：检查ubuntu是否运行成功，同时关闭加速器及梯子，或者sudo
## STM32hal学习
在keil5已经打开的项目，不可以同时在vscode中打开
### 总结目前已经配置完成的HAL库函数：
1. LED闪烁
~~~
 HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_5); 
    HAL_Delay(500); 
~~~

2. LED流水灯
~~~
需要把output level设置成高电平
HAL_GPIO_WritePin(GPIOA,GPIO_PIN_0,GPIO_PIN_RESET);
	HAL_Delay_ms(500);
HAL_GPIO_WritePin(GPIOA,GPIO_PIN_0,GPIO_PIN_SET);
~~~

3. 按键控制LED
~~~
时钟树设置为36MHz
按键设置为EXIT口，其余保持默认
在NVIC中开启中断
// 检测按键是否按下
    if (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_3) == GPIO_PIN_RESET) 
    {
      // 消抖处理
      HAL_Delay_ms(20); 
      if (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_3) == GPIO_PIN_RESET)
      {
        // 反转LED状态
        HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_0);
        // 等待按键释放
        while (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_3) == GPIO_PIN_RESET);
      }
    }
注意：关于按键的上拉下拉，需要根据面包板来自行调整
~~~

4. OLED显示
~~~
采取HAL发送I2C数据的显示方式
[参考教程](https://blog.csdn.net/weixin_56719449/article/details/130877410?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%A6%82%E4%BD%95%E5%9C%A8STM32cubeMX%E4%B8%AD%E5%AE%9E%E7%8E%B0OLED%E6%98%BE%E7%A4%BA&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-130877410.142^v101^control&spm=1018.2226.3001.4187)
[注意事项]
~~~

5. 红外传感器计数(目前未链接到OLED,,仅在串口展示)
~~~
[参考教程](https://blog.csdn.net/h568630659/article/details/121764481)
if(HAL_GPIO_ReadPin(GPIOA,GPIO_PIN_1) == 1)
    {
        HAL_GPIO_WritePin(GPIOC,GPIO_PIN_13,GPIO_PIN_RESET);//灭灯
        count++;  // 感应到高电平，次数加1
        printf("感应次数: %d\r\n", count); 
        HAL_Delay(100);
    }
    else
    {
        HAL_GPIO_WritePin(GPIOC,GPIO_PIN_13,GPIO_PIN_SET);//亮灯
        HAL_Delay(100);
    }
~~~

6. 旋转编码器计数
~~~
[参考教程](https://blog.csdn.net/WandZ123/article/details/124552211?ops_request_misc=%257B%2522request%255Fid%2522%253A%25229932268ac9559cc508e266d91be07e13%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=9932268ac9559cc508e266d91be07e13&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-124552211-null-null.142^v101^control&utm_term=%E4%BD%BF%E7%94%A8STM32cubeMX%E5%AE%9E%E7%8E%B0%E6%97%8B%E8%BD%AC%E7%BC%96%E7%A0%81%E5%99%A8%E8%AE%A1%E6%95%B0&spm=1018.2226.3001.4187)
注意串口（USART1）配置
int16_t Encoder_Count;

void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
{
	if(GPIO_Pin == GPIO_PIN_0)
	{
				if(HAL_GPIO_ReadPin(GPIOB,GPIO_PIN_1) == GPIO_PIN_RESET)
			{
					printf("Encoder_Count:%u\r\n",--Encoder_Count);
			}
	}
	if(GPIO_Pin == GPIO_PIN_1)
	{
				if(HAL_GPIO_ReadPin(GPIOB,GPIO_PIN_0) == GPIO_PIN_RESET)
			{
					printf("Encoder_Count:%u\r\n",++Encoder_Count);
			}
	}
}

~~~

7. 定时器外部中断+外部时钟
~~~
启动HAL中的时钟
回调函数：HAL_TIM_PeriodElapsedCallback(htim);
此定时器大多配合PWM驱动使用
~~~

~~~
PWM的详细介绍：
（https://blog.csdn.net/as480133937/article/details/99231677?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522cd3d00247ffa9cff61efac1d9de7648d%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=cd3d00247ffa9cff61efac1d9de7648d&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-99231677-null-null.142^v101^control&utm_term=%E4%BD%BF%E7%94%A8STM32cubeMX%E5%AE%9E%E7%8E%B0PWM%E9%A9%B1%E5%8A%A8LED%E5%91%BC%E5%90%B8%E7%81%AF&spm=1018.2226.3001.4187)
关于定时器对应引脚的使用，查阅STM32F1的数据手册
~~~

8. PWM驱动LED呼吸灯
~~~
uint16_t pwmVal=0;   //PWM占空比  
uint8_t dir=1;    
HAL_TIM_PWM_Start(&htim1,TIM_CHANNEL_1); //TIM1的PWM Channel1 输出
while(1)中函数用PWM的频率分段即可
~~~

9. PWM驱动舵机
~~~
在配置好HAL的基础上，新建两个.c及.h文件
#define Degrees_0 角度
提前定义Rotate函数
Rotate(2,Degrees_0);  
Rotate(2,Degrees_45);  
Rotate(2,Degrees_90);  
Rotate(2,Degrees_135);  
Rotate(2,Degrees_180);  
Rotate(2,Degrees_135);  
Rotate(2,Degrees_90);  
Rotate(2,Degrees_45);
......
~~~

10. PWM驱动直流电机
~~~
目前拥有的直流电机型号为TB6612FNG
[参考网站](https://blog.csdn.net/weixin_46286415/article/details/135532141?ops_request_misc=&request_id=&biz_id=102&utm_term=%E4%BD%BF%E7%94%A8STM32cubeMX%E5%AE%9E%E7%8E%B0PWM%E9%A9%B1%E5%8A%A8%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-135532141.142^v101^control&spm=1018.2226.3001.4187)

PWMA、AIN1、AIN2 为一组控制引脚，PWMA 为 PWM 速度控制引脚，AIN1、AIN2 为方向控制引脚；PWMB、BIN1、BIN2 为一组控制引脚，PWMB 为 PWM 速度控制引脚，BIN1、BIN2 为方向控制引脚。
此处代码省略
~~~

### 编译时的报错：
1. keil报错：No Target connected+Error: Flash Download failed - Target DLL has been cancelled。
    解决办法：这时候按住reset，再点击download，再松开reset。在程序运行到SWD引脚占用前把新的程序烧录进去，抢时间差。
2. Error: Flash Download failed  -  Could not load file 'Control the LED to turn on with buttons\Control the LED to turn on with buttons.axf'
	解决办法：存在语法编译错误，放到vscode中用copilot检查一下
3. Not enough information to list load addresses in the image map.
	解决办法：解决上面那个问题自然消失
## 数模学习
目前进展缓慢，想先过完课内需要预习的知识以及STM32HAL再进一步了解
~~~
(https://www.bilibili.com/video/BV1kC4y1a7Ee/?spm_id_from=333.999.0.0&vd_source=7b4eff40ff98814c5214b569dab69f65)
(https://pan.baidu.com/s/1qh_c1wfQArmewXjwYHuXQQ?pwd=yyzz)
(https://github.com/silence-breaker/Mathematical-Modeling)
~~~
下周过一下MATLAB的基础使用
## 线性代数+模拟电路基础学习

### 线性代数学完第三+部分第四章，重点知识总结：
1. 矩阵的初等变化
2. 矩阵的轶
3. 向量组的线性变化
4. 向量组的线性相关性
5. 向量组的轶 
### 模拟电路基础学到22节：
1. 总结前两周学习的内容：
重点在于：
	PN结与MOS管、结型场效应管、基本放大电路之间原理的联系
	基本放大电路的动态分析
	明确不同元件的特性曲线及横纵坐标
2. 提炼本周学习的内容：
	基本共基放大电路
	场效应管放大电路
	多级放大电路
	拆分放大电路

## 关于用vscode编写html网页
1. 基础代码
~~~
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
</head>
<body>
</body>
</html>
~~~

2. 具体页面的编辑
~~~
标题<h></h>
段落<p></p>
链接<a></a>
图片<img src="图片链接"/>
换行<br>
~~~

运用以上内容可编写简单的网页，剩余的复杂排版只需找到对应的代码及语法便可升级。
~~~
具体教程：
[基础代码解释]https://blog.csdn.net/zong596568821xp/article/details/83277729?ops_request_misc=%257B%2522request%255Fid%2522%253A%25225a8bca06a8b99b65265344696f502db6%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=5a8bca06a8b99b65265344696f502db6&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-83277729-null-null.142^v101^control&utm_term=html&spm=1018.2226.3001.4187
[部分拓展代码]https://blog.csdn.net/The_Best_Hacker/article/details/82891527
[vscode插件推荐]
HTML Snippets
Auto Rename Tag
open in browser/live server(直接预览网页画面，不需要另外保存)

~~~
